# 1

## 운영환경

* 암호모듈의 운영할 모듈에 요구되는 소프트웨어, 펌웨어, 하드웨어의 관리를 지칭함.

1. 운영환경 일반 요구사항 
   * **소프트웨어** 또는 **펌웨어**, **하이브리드 모듈**의 운영환경에는 적어도 **모듈 구성요소**와 **컴퓨팅 플랫폼**, 그 **컴퓨팅 플랫폼 상**에서 **소프트웨어 또는 펌웨어 실행을 관리 또는 허용하는 운영체제**를 포함
   * **하드웨어 모듈**은 모듈 내에 **내부 소프트웨어** 또는 **펌웨어의 실행**을 허용하는 **운영체제**로 구성된 운영환경을 가질 수 있음
   * 운영환경은 **변경불가능한 운영환경**, **제한적 운영환경**, **변경 가능한 운영환경**으로 나뉨.
   * 운영환경에서 **신뢰할 수 없는 기능**은 암호모듈의 **정해진 인터페이스**를 거치지 않고는 **민감한 정보(SSP)에 접근할 수 없도록** 해야 한다
   * 암호 모듈은 운영 환경 내 다른 기능들과 분리되어야 합니다.
   * 암호 모듈의 코드와 데이터를 정확하게 보호하기 위해, 운영 환경이 특정 방식으로 설정되어야 할 수 있습니다. 예를 들어, 암호 모듈 내부의 특정 통신을 막거나, 암호 모듈의 중요한 데이터나 코드가 들어 있는 파일에 제한된 접근 권한을 부여해야 할 수 있습니다.
2. 제한적인 운영환경 또는 변경 불가능한 운영환경의 요구사항(암호 모듈이 보안수준 1인 경우)
   * 변경 가능한 운영환경의 요구사항과 동일함
3. 변경 가능한 운영환경의 요구사항(암호모듈이 보안수준 1인 경우)
   * 암호모듈의 각 인스턴스는 **암호모듈 자신의 SSP**를 제어해야 한다.
   * 운영환경은 **응용 프로그램의 데이터**가 운영환경 내의 **프로세스 메모리**에 있거나 **영구 저장소**에 저장되는 것과 상관없이 인가되지 않은 CSP에 대한 접근과, 제어되지 않는 보안매개변수의 변경을 방지함으로써 각각의 응용 프로세스가 독립적으로 동작할 수 있도록 하는 기능을 제공해야 한다[06.06]. 이는 암호모듈과 운영체제의 신뢰되는 부분에 의해서 CSP와 SSP로의 직접 접근이 제한된다는 것을 말한다. 운영환경 설정에 대한 제한 사항은 암호모듈의 보안정책 문서에 서술되어야 한다
   * 암호모듈에 인해 생성된 프로세스는 해당 암호모듈에 의해서만 소유되어야 하며, 외부 프로세스/운영자는 소유할 수 없다

## 중요 보안매개변수 관리

1. 중요 보안매개변수 관리 일반 요구사항
   * 중요 보안 매개변수(SSP)는 핵심 보안매개변수(CSP)와 공개 보안매개변수(PSP)로 구성된다
   * SSP 관리를 위한 보안 요구사항은 모듈에서 사용하는 SSP의 전체 생명 주기를 포괄한다
   * SSP 관리에는 난수 발생기와 SSP생성, SSP 설정, SSP 주입/출력, SSP 저장, 보호하지 않은 SSP 제로화를 포함한다
   * CSP는 암호모듈 내에서 인가되지 않은 접근, 사용, 노출, 변경 및 대체로 부터 보호되어야 한다
   * PSP는 암호모듈 내에서 인가되지 않은 변경과 대체로 부터 보호되어야 한다
   * 암호모듈은 생성, 주입되거나 출력되는 SSP를 지정된 개체와 연계시켜야 한다
   * 패스워드의 해시값, 난수 발생기의 정보 및 키 생성 중간값은 제로화를 위한 보호된 SCP로 간주되어야 한다
2. 난수 발생기
   * 암호모듈은 난수 발생기와 난수 발생기의 체인을 포함하거나 단독으로 난수 발생기일 수 있다
   * 검증대상 알고리즘, SSP 생성 또는 SSP 설정에 난수가 요구된다면, 이를 제공하기 위해 검증대상 난수 발생기가 사용되어야 한다
   * 엔트로피가 암호모듈의 암호경계 외부에서 수집된다면, 엔트로피 입력으로 생성된 데이터는 CSP로 간주되어야 한다
3. 중요 매개 변수 생성
   * 모델은 내부적으로 SSP를 생성하거나 또는 모듈로 입력된 SSP에서 유도할 수 있다
   * 난수 발생기를 이용해서 민감 보안 매개변수(SSP)를 생성할 때, 그 SSP를 찾아내는 데는 매우 많은 계산 작업이 필요하도록 만들어야 한다
4. 중요 매개변수 설정
   * SSP 설정은 다음으로 구성 할 수 있다
     * 자동화된 SSP 전송 또는 SSP 합의 방법
     * 직접 또는 전자적 방법을 통한 수동 SSP 주입 또는 출력
   * 자동화된 SSP 설정은 부속서 D에 검증대상으로 정의된 방법을 사용해야 한다
5. 중요 보안 매개변수의 주입 및 출력
   * 중요 보안 매개변수는 수동으로 모듈에 주입되거나 외부로 출력되는 경우, 직접적으로 또는 전자식으로 수행된다
   * SSP가 모듈에 주입되거나 모듈 외부로 출력되는 경우, 암호를 사용하여 보호되는 모든 SSP는 검증 대상 암호 알고리즘을 이용하여 암호화 되어야 한다
   * 직접 주입되는 SSP의 경우 주입되는 값은 육안 검증을 허용하고, 정확성을 향상시키기 위해서 임시적으로 표시되어야 한다. 또한 SSP가 평문으로 표시되지 않아야 한다. 또한 암호모듈에 주입되는 동안 조건부 수동 주입 시험을 이용하여 정확한 주입여부가 확인되어야 한다.(7.10.3.5)
   * 중요 정보를 의도치 않게 출력하는 것을 방지하기 위하여 CSP가 평문으로 출력되는 경우 두개의 독립된 내부 조치가 있어야 한다
   * 무선 접속을 통한 전자식 주입 또는 출력의 경우, CSP, 키 구성 요소 및 인증 데이터는 암호화 되어야 한다
   * 수동으로 주입되는 PSP는 암호적으로 인증될 필요는 없다
   * 평문 CSP와 키 구성 요소, 인증 데이터는 암호모듈의 다른 물리적 포트와 논리적 인터페이스를 공유하는 물리적 포트와 논리적 인터페이스를 거쳐 주입 및 출력 할 수 있다
   * 소프트웨어 암호모듈 또는 하이브리드 소프트웨어 모듈의 소프트웨어 구성요소의 경우, CSP, 키 요소 및 인증 데이터가 운영 환경 내에서 관리되고, 7.6.3의 요구 사항을 충족한다면 평문이거나 암호화 된 형식으로 입출력 될 수 있다
6. 중요 보안 매개변수 저장
   * 모듈 내 저장된 SSP는 평문이나 암호화 된 형태로 저장 할 수 있다
   * 암호모듈 내부에 저장되는 모든 SSP는 SSP를 지정한 개체와 연계되어야 한다
   * 인가되지 않은 운영자가 CSP에 접근 할 수 없다
   * 인가되지 않은 운영자는 PSP를 변경 할 수 없다
7. 중요 보안매개변수의 제로화
   * 암호모듈 내부에서 보호되지 않은 모든 SSP와 키 구성 요소를 제로화 하는 방법을 제공 해야한다,
   * 임시로 저장된 SSP와 모듈에 의해 소유된 다른 저장된 값은 미래 용도로 더 이상 필요 없을때 제로화 해야한다.
   * 제로화 된 SSP는 복구되거나 재사용 할 수 없다.
   * 보호된 PSP의 제로화, 암호화 된 CSP의 제로화, 추가 내장형 검증필 암호 모듈내에서 물리적 또는 논리적으로 보호된 CSP의 제로화는 요구되니 않는다.
   * 인증 프록시 과정에 어쩔수 없이 평문 데이터로 보여지는 경우 SSP는 제로화 요구사항을 만족시킬 필요가 없다.
   * 단지 자가시험에만 사용하는 매개변수는 제로화 요구사항을 만족 할 필요가 없다.
   * 보호하지 않은 SSP의 제로화는 모듈 운영자와 모듈의 독립적인 컨트롤에 의해서 절차적으로 수행된다.



# 2

## 운영환경

1. 운영환경 일반 요구사항

2. 변경 불가능한 운영환경 또는 제한적인 운영환경인 경우 7.6.2

3. 변경가능한 운영환경인 경우 7.6.3

   * 암호모듈의 각 인스턴스는 암호모듈 스스로의 SSP를 제어해야 한다.

   * 운영환경은 응용 프로그램의 데이터가 운영환경 내의 프로세스 메모리에 있든지 영구 저장소에 저장되든지 상관없이 인가되지않은 CSP에 대한 접근과 제어되지 않는 보안매개변수의 변경을 방지하여 각각의 응용 프로세스가 독립적으로 작동할 수 있도록 하는 기능을 제공해야 한다,
   * 암호모듈에 인해 생성된 프로세스는 해당 암호모듈에 의해서만 소유되어야 하며 외부 프로세스나 운영자에 의해 소유될 수 없다



## 중요 보안 매개변수 관리

* CSP는 암호모듈 내에서 인가되지 않은 접근, 사용, 노출, 변경 및 대체로 부터 보호되어야 한다

* PSP는 암호모듈 내에서 인가되지 않은 변경과 대체로부터 보호되어야 한다

* 암호모듈은 생성, 주입되거나 출력되는 SSP를 지정된 개체와 연계시켜야 한다

* 패스워드의 해시값, 난수 발생기의 상태 정보 및 키 생성 중간값은 CSP로 간주되어야 한다

* 암호모듈은 다수의 난수 발생기, 난수 발생기의 체인 또는 단 하나의 난수 발생기를 포함 할 수 있다.

* 검증대상 암호 알고리즘, SSP 생성 또는 SSP 설정에 난수가 필요하면, 이를 제공하기 위해 검증대상 난수 발생기가 사용되어야 한다

* 엔트로피가 암호모듈의 암호 경계 외부에서 수집된다면, 엔트로피 입력으로 생성된 데이터는 CSP로 간주되어야 한다

* 검증대상 난수 발생기의 출력을 이용하는 SSP 생성을 손상하는 행위는 적어도 생성된 SSP의 값을 전수 조사로 찾는 만큼의 연산량을 필요로 해야한다

* 검증대상 난수 발생기를 이용하여 모듈에서 생성되거나 모듈에 주입된 SSP로부터 유도된 것으로, 검증대상 암호 알고리즘 또는 SSP 설정에 사용되는 SSP는 19790의 부속서 D의 목록에 제시된 검증대상 SSP 생성 방법을 사용해야 한다.

* 자동화된 SSP 설정은 KS X ISO/IEC 19790의 부속서 D에서 목록으로 제공된다

* SSP가 수동으로 모듈에 주입되거나 외부로 출력되는 경우 주입 또는 출력은 HMI, SFMI, HFMI 또는 HSMI 인터페이스를 사용해야 한다

* SSP가 모듈에 주입되거나 모듈 외부로 출력되는 경우 암호를 사용하여 보호 되는 모든 SSP는 검증 대상 암호알고리즘을 이용하여 암호화 되어야 한다

* 암호화된 SSP가 직접 모듈에 주입되는 경우, SSP가 평문으로 표시되지 않아야 한다.

* 직접 주입되는 (평문이거나 암호화된) SSP는 암호모듈에 주입되는 동안 KS X ISO/IEC 19790의 **7.10.3.5**에 정의된 조건부 수동 주입 시험을 이용하여 정확한 주입 여부가 확인되어야 한다.

* 중요 정보를 의도치 않게 출력하는 것을 방지하기 위하여, CSP가 평문으로 출력되는 경우 두 개의 독립된 내부 조치가 있어야 한다.

* 위에서 정의된 두 개의 독립된 내부 조치는 CSP 출력 설정에만 전용으로 사용되어야 한다.

* 무선 접속을 통한 전자식 주입 또는 출력의 경우, CSP, 키 구성 요소 및 인증 데이터는 암호화되어야 한다.

* 소프트웨어 암호모듈 또는 하이브리드 소프트웨어 모듈의 소프트웨어 구성 요소의 경우, CSP, 키 요소 및 인증 데이터가 운영환경 내에서 관리되고, KS X ISO/IEC 19790의 **7.6.3**의 요구사항을 충족한다면 평문이거나 암호화된 형식으로 입출력될 수 있다.

* 암호모듈 내부에 저장되는 모든 SSP는 SSP를 지정한 개체(예: 운영자, 역할, 프로세스)와 연계되어야 한다.

* 인가되지 않은 운영자가 평문 CSP에 접근하는 것은 금지되어야 한다.

* 인가되지 않은 운영자에 의한 PSP 변경은 금지되어야 한다.

* 암호모듈 내부에서 보호되지 않은 모든 SSP와 키 구성 요소를 제로화하는 방법을 제공해야 한다.

* 제로화된 SSP는 복구되거나 재사용될 수 없어야 한다.

   

